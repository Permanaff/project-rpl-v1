{% extends 'layout.html' %}
{% block head %}
<title>New Star Cinplex</title>

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/OwlCarousel2/2.3.4/assets/owl.carousel.min.css" integrity="sha512-tS3S5qG0BlhnQROyJXvNjeEM4UpMXHrQfTGmbQ1gKmelCxlSEBUaxhRBj/EFTzpbP4RVSrpEikbmdJobCvhE3g==" crossorigin="anonymous" referrerpolicy="no-referrer" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/OwlCarousel2/2.3.4/assets/owl.theme.default.css" integrity="sha512-OTcub78R3msOCtY3Tc6FzeDJ8N9qvQn1Ph49ou13xgA9VsH9+LRxoFU6EqLhW4+PKRfU+/HReXmSZXHEkpYoOA==" crossorigin="anonymous" referrerpolicy="no-referrer" />


<style>

    .btn-nav:focus,
    .btn-nav:active {
        border: 0px;
        
    }
    .btn-nav {
        color: #0d6efd;
        border: 0px;
    }
    .btn-nav:hover {
        color: #2064cc;
    }

    p, h5 {
        /* color: white; */
        color: black;
    }


    .card-body {
        color: black;
    }

    #showing, #upcoming {
        /* background-color: #37373E; */
        background-color: #f7f9fd;
    }

    .movie-card, .upcoming-card {
        /* background-color: #37373E; */
        background-color: #f7f9fd;

    }

    /* .upcoming-card {
        background-color: #37373E;
    } */

    .owl-theme .owl-dots .owl-dot.active span {
        background-color: #0d6efd;
    }

    .owl-dots{
        position: absolute;
        right: 0;
        left: 0;
        padding-top: 15px;
        margin: 100px;
    }

    i {
        font-size: 40px;
    }

    .carousel-img {
        border-radius: 15px
    }

    /* .carousel-item .carousel-item-next .carousel-item-start img{
        border-radius: 15px;
    }
     */
    .carousel-inner {
        margin-bottom: 50px;
    }
    #carousel-home {
        width: 1000px;
    }

    .carousel-indicators{
        position: absolute;
        bottom: -25px;
    }



    .carousel-indicators [data-bs-target]  {
        width: 10px;
        height: 10px; 
        border-radius: 50%;
        background-color: #e3e3e3; 
        border: none; 
    }
    .carousel-indicators [data-bs-target]:hover  {
        background-color: #869791; 
    }

    .carousel-indicators .active {
        background-color: #0d6efd; 
    }



    


</style>


{%endblock%}

{%block body%}
    <div class="container">
        <div class="container mt-4 d-flex justify-content-center">
            <div id="carousel-home" class="carousel slide" data-bs-ride="carousel">
                <div class="carousel-inner">
                    <!-- <div class="carousel-item active">
                        <img src="/static/images/carousel/171160633149812_925x527.jpg" class="d-block w-100 carousel-img rounded-3" alt="...">
                    </div>
                    <div class="carousel-item">
                        <img src="/static/images/carousel/171160641816969_925x527.jpg" class="d-block w-100 carousel-img rounded-3" alt="...">
                    </div>
                    <div class="carousel-item">
                        <img src="/static/images/carousel/171194224929857_925x527.jpg" class="d-block w-100 carousel-img rounded-3" alt="...">
                    </div>
                    <div class="carousel-item">
                        <img src="/static/images/carousel/171194224929857_925x527.jpg" class="d-block w-100 carousel-img rounded-3" alt="...">
                    </div> -->
                </div>
                <button class="carousel-control-prev" type="button" data-bs-target="#carousel-home" data-bs-slide="prev">
                    <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                    <span class="visually-hidden">Previous</span>
                </button>
                <button class="carousel-control-next" type="button" data-bs-target="#carousel-home" data-bs-slide="next">
                    <span class="carousel-control-next-icon" aria-hidden="true"></span>
                    <span class="visually-hidden">Next</span>
                </button>
                <div class="carousel-indicators">
                    <!-- <button type="button" data-bs-target="#carousel-home" data-bs-slide-to="0" class="active" aria-current="true" aria-label="Slide 1"></button>
                    <button type="button" data-bs-target="#carousel-home" data-bs-slide-to="1" aria-label="Slide 2"></button>
                    <button type="button" data-bs-target="#carousel-home" data-bs-slide-to="2" aria-label="Slide 3"></button>
                    <button type="button" data-bs-target="#carousel-home" data-bs-slide-to="3" aria-label="Slide 3"></button> -->
                </div>
            </div>
        </div>
    </div>
  
    
    <section id="showing" class="my-5 py-3">
        <div class="container">
            <div class="d-flex mt-3" style="margin-bottom: -5px;">
                <div class="container overflow-hidden text-start">
                    <div class="row gx-5">
                        <div class="col">
                            <p class="fs-4 fw-bold">NOW SHOWING IN CINEMAS</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="container">
            <div class="container d-flex justify-content-center gap-4 mt-3 flex-wrap">
                <div class="owl-carousel owl-theme"  id="movie-list">
                    
                </div>
            </div>
            <div class="container mt-2">
                <div class="row">
                    <div class="col d-flex justify-content-start">
                        <button class="btn btn-nav" id="customPrevBtn" aria-hidden="true">
                            <i class="fa-solid fa-circle-chevron-left"></i>
                            <span class="visually-hidden">Prev</span>
                        </button>
                    </div>
                
                    <div class="col d-flex justify-content-end">
                        <button class="btn btn-nav" id="customNextBtn" aria-hidden="true">
                            <i class="fa-solid fa-circle-chevron-right"></i>
                            <span class="visually-hidden">Next</span>
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <section id="upcoming" class="my-5 py-3">
        <div class="container">
            <div class="d-flex mt-3" style="margin-bottom: -5px;">
                <div class="container overflow-hidden text-start">
                    <div class="row gx-5">
                        <div class="col">
                            <p class="fs-4 fw-bold">UPCOMING</p>
                        </div>
                    </div>
                  </div>
            </div>
        </div>
        <div class="container">
            <div class="container d-flex justify-content-center gap-4 mt-3 flex-wrap">
                <div class="owl-carousel owl-theme"  id="upcoming-list">
                    <!-- Container Upcoming Movie -->
                </div>
            </div>
            <div class="container mt-2">
                <div class="row">
                    <div class="col d-flex justify-content-start">
                        <button class="btn btn-nav" id="customPrevBtnUp" aria-hidden="true">
                            <i class="fa-solid fa-circle-chevron-left"></i>
                            <span class="visually-hidden">Prev</span>
                        </button>
                    </div>
                    <div class="col" id="nav-carousel">
                        <!-- Tempat untuk titik navigasi -->
                      </div>
                    <div class="col d-flex justify-content-end">
                        <button class="btn btn-nav" id="customNextBtnUp" aria-hidden="true">
                            <i class="fa-solid fa-circle-chevron-right"></i>
                            <span class="visually-hidden">Next</span>
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </section>



    

    <div class="container d-flex justify-content-center gap-4 mt-5 flex-wrap text-center" id="commingsoon-movie">
        
        
        
    </div>


{%endblock%}

{%block scripts%}
<script src="https://cdnjs.cloudflare.com/ajax/libs/OwlCarousel2/2.3.4/owl.carousel.min.js" integrity="sha512-bPs7Ae6pVvhOSiIcyUClR7/q2OAsRiovw4vAkX+zJbw3ShAeeqezq50RIIcIURq7Oa20rW2n2q+fyXBNcU9lrw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
<script>
    $(document).ready(function() {
        show_carousel()
        showing_movies()
        upcoming_movie()
        

        
        // Go to the next item
        $('#customNextBtn').click(function() {
            $('#movie-list').trigger('next.owl.carousel');
        })
        
        // Go to the previous item
        $('#customPrevBtn').click(function() {
            // With optional speed parameter
            // Parameters has to be in square bracket '[]'
            $('#movie-list').trigger('prev.owl.carousel', [300]);
        })
        
        // Go to the next item
        $('#customNextBtnUp').click(function() {
            $('#upcoming-list').trigger('next.owl.carousel');
        })
        
        // Go to the previous item
        $('#customPrevBtnUp').click(function() {
            // With optional speed parameter
            // Parameters has to be in square bracket '[]'
            $('#upcoming-list').trigger('prev.owl.carousel', [300]);
        })
        
        
    });

        let showing_movies = () =>{
            // fetch('http://127.0.0.1:4000/showing-movies',{
            // method: 'POST',})
            fetch('http://127.0.0.1:4000/showing-movies',{
            method: 'POST',})
                .then(response => response.json())
                .then(response => {
                    const containerFilm = document.getElementById('movie-list');
                    const containerFilmPopuler = document.getElementById('comingsoon-movie');
                    let showing_movies = '';
                    response.showing_movies.forEach(movie => {
                        showing_movies += `
                            <div class="item">
                                <a href="/movies-page/${movie.id_movie}" style="text-decoration: none; color: black;">
                                    <div class="card border-0 movie-card" style="height: 500px;">
                                        <img class="rounded-3" src="/static/images/poster/${movie.poster}" alt="${movie.title}">
                                        <div class="card-body text-center">
                                            <h5 class="fs-6 flex-wrap fw-bold" style="height: 60px;">${movie.title}</h5>
                                            <p class="fw-light">${movie.tahun} | ${movie.rating}</p>
                                        </div>
                                    </div>
                                </a>
                            </div>
                        `;
                    });
                    containerFilm.innerHTML = showing_movies;

                    $('#movie-list').owlCarousel({
                        loop:false,
                        margin:15,
                        nav:false,
                        dots:true,
                        responsive:{
                            0:{
                                items:1
                            },
                            600:{
                                items:3
                            },
                            1000:{
                                items:5
                            }
                        }
                    })
                
            })
            .catch(error => {
                console.error('Gagal mengambil data:', error);
            });
        }

        let upcoming_movie = () =>{
            fetch('http://127.0.0.1:4000/upcoming-movies',{
            method: 'POST',})
                .then(response => response.json())
                .then(response => {
                    const containerFilm = document.getElementById('upcoming-list');
                    let showing_movies = '';
                    response.showing_movies.forEach(movie => {
                        showing_movies += `
                            <div class="item">
                                <a href="/movies-page/${movie.id_movie}" style="text-decoration: none; color: black;">
                                    <div class="card border-0 upcoming-card" style="height: 500px;">
                                        <img class="rounded-3" src="/static/images/poster/${movie.poster}" alt="${movie.title}">
                                        <div class="card-body text-center">
                                            <h5 class="fs-6 flex-wrap fw-bold" style="height: 60px;">${movie.title}</h5>
                                            <p class="fw-light">${movie.tahun} | ${movie.rating}</p>
                                        </div>
                                    </div>
                                </a>
                            </div>
                        `;
                    });
                    containerFilm.innerHTML = showing_movies;

                    $('#upcoming-list').owlCarousel({
                        loop:false,
                        margin:15,
                        nav:false,
                        dots:true,
                        responsive:{
                            0:{
                                items:1
                            },
                            600:{
                                items:3
                            },
                            1000:{
                                items:5
                            }
                        }
                    })
            })
            .catch(error => {
                console.error('Gagal mengambil data:', error);
            });
        }

        let show_carousel = () => {
        fetch('http://127.0.0.1:4000/get-carousel', {
                method: 'POST',
            })
            .then(response => response.json())
            .then(response => {
                const containerCarousel = $('.carousel-inner');
                const indicators = $('.carousel-indicators');
                let showing_carousel = '';
                let indicators_content = '';
                let indeks = 0;
                
                response.carousel.forEach((carousel, index) => {
                    if (index === 0) {
                        showing_carousel += `
                            <div class="carousel-item active">
                                <img src="/static/images/carousel/${carousel.image_carousel}" class="d-block w-100 carousel-img rounded-3" alt="${carousel.nama_carousel}">
                            </div>
                        `;
                        indicators_content += `
                            <button type="button" data-bs-target="#carousel-home" data-bs-slide-to="${index}" aria-label="Slide ${index}" class="active"></button>
                        `;
                    } else {
                        showing_carousel += `
                            <div class="carousel-item">
                                <img src="/static/images/carousel/${carousel.image_carousel}" class="d-block w-100 carousel-img rounded-3" alt="${carousel.nama_carousel}">
                            </div>
                        `;
                        indicators_content += `
                            <button type="button" data-bs-target="#carousel-home" data-bs-slide-to="${index}" aria-label="Slide ${index}"></button>
                        `;
                    }
                });
                containerCarousel.html(showing_carousel);
                indicators.html(indicators_content);
              
            })
            .catch(error => {
                console.error('Gagal mengambil data:', error);
            });
    }



        
    
</script>
{%endblock%}
